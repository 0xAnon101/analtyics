if(typeof Influence==='undefined'){var Influence=function(options){if(!(this instanceof Influence))return new Influence(config);tracker=new InfluenceTracker(options.trackingId);options=options||{};this.options=options;this.trackerInstance=tracker;this.initialize()};(function(Influence){Influence.prototype.options=function(){return this.options};var BrowserDetect=(function(){var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)
        return data[i].identity}
    else if(dataProp)
        return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPod",identity:"iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();return BrowserDetect})();var Geo={};Geo.geoip=function(success,failure){if(typeof geoip2!=='undefined'){geoip2.city(function(results){success({latitude:success.location.latitude,longitude:success.location.longitude})},failure,{timeout:2000,w3c_geolocation_disabled:!0})}};var Util={};Util.copyFields=function(source,target){var createDelegate=function(source,value){return function(){return value.apply(source,arguments)}};target=target||{};var key,value;for(key in source){if(!/layerX|Y/.test(key)){value=source[key];if(typeof value==='function'){target[key]=createDelegate(source,value)}else{target[key]=value}}}
    return target};Util.merge=function(o1,o2){var r,key,index;if(o1===undefined)return o1;else if(o2===undefined)return o1;else if(o1 instanceof Array&&o2 instanceof Array){r=[];for(index=0;index<o1.length;index++){r.push(o1[index])}
    for(index=0;index<o2.length;index++){if(r.length>index){r[index]=Util.merge(r[index],o2[index])}else{r.push(o2[index])}}
    return r}else if(o1 instanceof Object&&o2 instanceof Object){r={};for(key in o1){r[key]=o1[key]}
    for(key in o2){if(r[key]!==undefined){r[key]=Util.merge(r[key],o2[key])}else{r[key]=o2[key]}}
    return r}else{return o2}};Util.toObject=function(olike){var o={},key;for(key in olike){o[key]=olike[key]}
    return o};Util.genGuid=function(){var s4=function(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1)};return s4()+s4()+'-'+s4()+'-'+s4()+'-'+s4()+'-'+s4()+s4()+s4()};Util.parseQueryString=function(qs){var pairs={};if(qs.length>0){var query=qs.charAt(0)==='?'?qs.substring(1):qs;if(query.length>0){var vars=query.split('&');for(var i=0;i<vars.length;i++){if(vars[i].length>0){var pair=vars[i].split('=');try{var name=decodeURIComponent(pair[0]);var value=(pair.length>1)?decodeURIComponent(pair[1]):'true';pairs[name]=value}catch(e){}}}}}
    return pairs};Util.unparseQueryString=function(qs){var kvs=[],k,v;for(k in qs){if(!qs.hasOwnProperty||qs.hasOwnProperty(k)){v=qs[k];kvs.push(encodeURIComponent(k)+'='+encodeURIComponent(v))}}
    var string=kvs.join('&');if(string.length>0)return'?'+string;else return''};Util.size=function(v){if(v===undefined)return 0;else if(v instanceof Array)return v.length;else if(v instanceof Object){var size=0;for(var key in v){if(!v.hasOwnProperty||v.hasOwnProperty(key))++size}
    return size}else return 1};Util.mapJson=function(v,f){var vp,vv;if(v instanceof Array){vp=[];for(var i=0;i<v.length;i++){vv=Util.mapJson(v[i],f);if(Util.size(vv)>0)vp.push(vv)}
    return vp}else if(v instanceof Object){vp={};for(var k in v){vv=Util.mapJson(v[k],f);if(Util.size(vv)>0)vp[k]=vv}
    return vp}else return f(v)};Util.jsonify=function(v){return Util.mapJson(v,function(v){if(v==='')return undefined;else{var r;try{r=JSON.parse(v)}catch(e){r=v}
    return r}})};Util.undup=function(f,cutoff){cutoff=cutoff||250;var lastInvoked=0;return function(){var curTime=(new Date()).getTime();var delta=curTime-lastInvoked;if(delta>cutoff){lastInvoked=curTime;return f.apply(this,arguments)}else{return undefined}}};Util.parseUrl=function(url){var l=document.createElement("a");l.href=url;if(l.host===''){l.href=l.href}
    return{hash:l.hash,host:l.host,hostname:l.hostname,pathname:l.pathname,protocol:l.protocol,query:Util.parseQueryString(l.search)}};Util.unparseUrl=function(url){return(url.protocol||'')+'//'+(url.host||'')+(url.pathname||'')+Util.unparseQueryString(url.query)+(url.hash||'')};Util.equals=function(v1,v2){var leftEqualsObject=function(o1,o2){for(var k in o1){if(!o1.hasOwnProperty||o1.hasOwnProperty(k)){if(!Util.equals(o1[k],o2[k]))return!1}}
    return!0};if(v1 instanceof Array){if(v2 instanceof Array){if(v1.length!==v2.length)return!1;for(var i=0;i<v1.length;i++){if(!Util.equals(v1[i],v2[i])){return!1}}
    return!0}else{return!1}}else if(v1 instanceof Object){if(v2 instanceof Object){return leftEqualsObject(v1,v2)&&leftEqualsObject(v2,v1)}else{return!1}}else{return v1===v2}};Util.isSamePage=function(url1,url2){url1=url1 instanceof String?Util.parseUrl(url1):url1;url2=url2 instanceof String?Util.parseUrl(url2):url2;return url1.protocol===url2.protocol&&url1.host===url2.host&&url1.pathname===url2.pathname&&Util.equals(url1.query,url2.query)};Util.qualifyUrl=function(url){var escapeHTML=function(s){return s.split('&').join('&amp;').split('<').join('&lt;').split('"').join('&quot;')};var el=document.createElement('div');el.innerHTML='<a href="'+escapeHTML(url)+'">x</a>';return el.firstChild.href};Util.padLeft=function(n,p,c){var pad_char=typeof c!=='undefined'?c:'0';var pad=new Array(1+p).join(pad_char);return(pad+n).slice(-pad.length)};var DomUtil={};DomUtil.getFormData=function(node){var acc={};var setField=function(name,value){if(name==='')name='anonymous';var oldValue=acc[name];if(oldValue!=null){if(oldValue instanceof Array){acc[name].push(value)}else{acc[name]=[oldValue,value]}}else{acc[name]=value}};for(var i=0;i<node.elements.length;i++){var child=node.elements[i];var nodeType=child.tagName.toLowerCase();if(nodeType=='input'||nodeType=='textfield'){if((child.getAttribute('autocomplete')||'').toLowerCase()!=='off'){if(child.type!=='password'){if(child.type!=='radio'||child.checked){setField(child.name,child.value)}}}}else if(nodeType=='select'){var option=child.options[child.selectedIndex];setField(child.name,option.value)}}
    return acc};DomUtil.monitorElements=function(tagName,onnew,refresh){refresh=refresh||50;var checker=function(){var curElements=document.getElementsByTagName(tagName);for(var i=0;i<curElements.length;i++){var el=curElements[i];var scanned=el.getAttribute('influence_scanned');if(!scanned){el.setAttribute('influence_scanned',!0);try{onnew(el)}catch(e){window.onerror(e)}}}
    setTimeout(checker,refresh)};setTimeout(checker,0)};DomUtil.getDataset=function(node){if(typeof node.dataset!=='undefined'){return Util.toObject(node.dataset)}else if(node.attributes){var dataset={};var attrs=node.attributes;for(var i=0;i<attrs.length;i++){var name=attrs[i].name;var value=attrs[i].value;if(name.indexOf('data-')===0){name=name.substr('data-'.length);dataset[name]=value}}
    return dataset}else return{}};DomUtil.genCssSelector=function(node){var sel='';while(node!=document.body){var id=node.id;var classes=typeof node.className==='string'?node.className.trim().split(/\s+/).join("."):'';var tagName=node.nodeName.toLowerCase();if(id&&id!=="")id='#'+id;if(classes!=="")classes='.'+classes;var prefix=tagName+id+classes;var parent=node.parentNode;var nthchild=1;for(var i=0;i<parent.childNodes.length;i++){if(parent.childNodes[i]===node)break;else{var childTagName=parent.childNodes[i].tagName;if(childTagName!==undefined){nthchild=nthchild+1}}}
    if(sel!=='')sel='>'+sel;sel=prefix+':nth-child('+nthchild+')'+sel;node=parent}
    return sel};DomUtil.getNodeDescriptor=function(node){return{id:node.id,selector:DomUtil.genCssSelector(node),title:node.title===''?undefined:node.title,data:DomUtil.getDataset(node)}};DomUtil.getAncestors=function(node){var cur=node;var result=[];while(cur&&cur!==document.body){result.push(cur);cur=cur.parentNode}
    return result};DomUtil.simulateMouseEvent=function(element,eventName,options){var eventMatchers={'HTMLEvents':/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,'MouseEvents':/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/};options=Util.merge({pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0},options||{});var oEvent,eventType=null;for(var name in eventMatchers){if(eventMatchers[name].test(eventName)){eventType=name;break}}
    if(!eventType)throw new SyntaxError('Only HTMLEvents and MouseEvents interfaces are supported');if(document.createEvent){oEvent=document.createEvent(eventType);if(eventType==='HTMLEvents'){oEvent.initEvent(eventName,options.bubbles,options.cancelable)}else{oEvent.initMouseEvent(eventName,options.bubbles,options.cancelable,document.defaultView,options.button,options.pointerX,options.pointerY,options.pointerX,options.pointerY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,element)}
        element.dispatchEvent(oEvent)}else{options.clientX=options.pointerX;options.clientY=options.pointerY;var evt=document.createEventObject();oEvent=Util.merge(evt,options);try{element.fireEvent('on'+eventName,oEvent)}catch(error){element.fireEvent('on'+eventName)}}
    return element};var ArrayUtil={};ArrayUtil.removeElement=function(array,from,to){var tail=array.slice((to||from)+1||array.length);array.length=from<0?array.length+from:from;return array.push.apply(array,tail)};ArrayUtil.toArray=function(alike){var arr=[],i,len=alike.length;arr.length=alike.length;for(i=0;i<len;i++){arr[i]=alike[i]}
    return arr};ArrayUtil.contains=function(array,el){return ArrayUtil.exists(array,function(e){return e===el})};ArrayUtil.diff=function(arr1,arr2){var i,el,diff=[];for(i=0;i<arr1.length;i++){el=arr1[i];if(!ArrayUtil.contains(arr2,el))diff.push(el)}
    return diff};ArrayUtil.exists=function(array,f){for(var i=0;i<array.length;i++){if(f(array[i]))return!0}
    return!1};ArrayUtil.map=function(array,f){var r=[],i;for(i=0;i<array.length;i++){r.push(f(array[i]))}
    return r};var Env={};Env.getFingerprint=function(){var data=[JSON.stringify(Env.getPluginsData()),JSON.stringify(Env.getLocaleData()),navigator.userAgent.toString()];return MD5.hash(data.join(""))};Env.getBrowserData=function(){var fingerprint=Env.getFingerprint();return({ua:navigator.userAgent,name:BrowserDetect.browser,version:BrowserDetect.version,platform:BrowserDetect.OS,language:navigator.language||navigator.userLanguage||navigator.systemLanguage,plugins:Env.getPluginsData()})};Env.getUrlData=function(){var l=document.location;return({hash:l.hash,host:l.host,hostname:l.hostname,pathname:l.pathname,protocol:l.protocol,query:Util.parseQueryString(l.search)})};Env.getDocumentData=function(){return({title:document.title,referrer:document.referrer&&Util.parseUrl(document.referrer)||undefined,url:Env.getUrlData()})};Env.getScreenData=function(){return({height:screen.height,width:screen.width,colorDepth:screen.colorDepth})};Env.getLocaleData=function(){var results=new RegExp('([A-Z]+-[0-9]+) \\(([A-Z]+)\\)').exec((new Date()).toString());var gmtOffset,timezone;if(results&&results.length>=3){gmtOffset=results[1];timezone=results[2]}
    return({language:navigator.systemLanguage||navigator.userLanguage||navigator.language,timezoneOffset:(new Date()).getTimezoneOffset(),gmtOffset:gmtOffset,timezone:timezone})};Env.getPageloadData=function(){var l=document.location;return{browser:Env.getBrowserData(),document:Env.getDocumentData(),screen:Env.getScreenData(),locale:Env.getLocaleData()}};Env.getPluginsData=function(){var plugins=[];var p=navigator.plugins;for(var i=0;i<p.length;i++){var pi=p[i];plugins.push({name:pi.name,description:pi.description,filename:pi.filename,version:pi.version,mimeType:(pi.length>0)?({type:pi[0].type,description:pi[0].description,suffixes:pi[0].suffixes}):undefined})}
    return plugins};var Handler=function(){this.handlers=[];this.onerror=(console&&console.log)||window.onerror||(function(e){})};Handler.prototype.push=function(f){this.handlers.push(f)};Handler.prototype.dispatch=function(){var args=Array.prototype.slice.call(arguments,0),i;for(i=0;i<this.handlers.length;i++){try{this.handlers[i].apply(null,args)}
catch(e){onerror(e)}}};var Events={};Events.onready=function(f){if(document.body!=null)f();else setTimeout(function(){Events.onready(f)},10)};Events.onevent=function(el,type,capture,f_){var fixup=function(f){return function(e){if(!e)e=window.event;e=Util.copyFields(e);e.target=e.target||e.srcElement;e.keyCode=e.keyCode||e.which||e.charCode;e.which=e.which||e.keyCode;e.charCode=(typeof e.which==="number")?e.which:e.keyCode;e.timeStamp=e.timeStamp||(new Date()).getTime();if(e.target&&e.target.nodeType==3)e.target=e.target.parentNode;var retVal;if(!e.preventDefault){e.preventDefault=function(){retVal=!1}}
    return f(e)||retVal}};var f=fixup(f_);if(el.addEventListener){el.addEventListener(type,f,capture)}else if(el.attachEvent){el.attachEvent('on'+type,f)}};Events.onexit=(function(){var unloaded=!1;var handler=new Handler();var handleUnload=function(e){if(!unloaded){handler.dispatch(e);unloaded=!0}};Events.onevent(window,'unload',undefined,handleUnload);var replaceUnloader=function(obj){var oldUnloader=obj.onunload||(function(e){});obj.onunload=function(e){handleUnload();oldUnloader(e)}};replaceUnloader(window);Events.onready(function(){replaceUnloader(document.body)});return function(f){handler.push(f)}})();Events.onengage=(function(){var handler=new Handler();var events=[];Events.onready(function(){Events.onevent(document.body,'mouseover',!0,function(e){events.push(e)});Events.onevent(document.body,'mouseout',!0,function(end){var i,start;for(i=events.length-1;i>=0;i--){if(events[i].target===end.target){start=events[i];ArrayUtil.removeElement(events,i);break}}
    if(start!==undefined){var delta=(end.timeStamp-start.timeStamp);if(delta>=1000&&delta<=20000){handler.dispatch(start,end)}}})});return function(f){handler.push(f)}})();Events.onhashchange=(function(){var handler=new Handler();var lastHash=document.location.hash;var dispatch=function(e){var newHash=document.location.hash;if(lastHash!=newHash){lastHash=newHash;e.hash=newHash;handler.dispatch(e)}};if(window.onhashchange){Events.onevent(window,'hashchange',!1,dispatch)}else{setInterval(function(){dispatch({})},25)}
    return function(f){handler.push(f)}})();Events.onerror=(function(){var handler=new Handler();if(typeof window.onerror==='function')handler.push(window.onerror);window.onerror=function(err,url,line){handler.dispatch(err,url,line)};return function(f){handler.push(f)}})();Events.onsubmit=(function(){var handler=new Handler();var handle=Util.undup(function(e){handler.dispatch(e)});Events.onready(function(){Events.onevent(document.body,'submit',!0,function(e){handle(e)});Events.onevent(document.body,'keypress',!1,function(e){if(e.keyCode==13){var target=e.target;var form=target.form;if(form){e.form=form;handle(e)}}});Events.onevent(document.body,'click',!1,function(e){var target=e.target;var targetType=(target.type||'').toLowerCase();if(target.form&&(targetType==='submit'||targetType==='button')){e.form=target.form;handle(e)}})});return function(f){handler.push(f)}})();Influence.prototype.initialize=function(){var self=this;this.options=Util.merge({bucket:'none',breakoutUsers:!1,breakoutVisitors:!1,waitOnTracker:!1,resolveGeo:!0,trackPageViews:!0,trackClicks:!0,trackHashChanges:!0,trackEngagement:!0,trackLinkClicks:!0,trackRedirects:!0,trackSubmissions:!0},this.options);this.javascriptRedirect=!0;this.context={};this.context.fingerprint=Env.getFingerprint();this.context.sessionId=(function(){var sessionId=sessionStorage.getItem('influence_sid')||Util.genGuid();sessionStorage.setItem('influence_sid',sessionId);return sessionId})();this.context.visitorId=(function(){var visitorId=localStorage.getItem('influence_vid')||Util.genGuid();localStorage.setItem('influence_vid',visitorId);return visitorId})();this.context.trackingId=this.options.trackingId;this.context.userId=JSON.parse(localStorage.getItem('influence_uid')||'null');this.context.userProfile=JSON.parse(localStorage.getItem('influence_uprofile')||'null');self.oldHash=document.location.hash;var trackJump=function(hash){if(self.oldHash!==hash){var id=hash.substring(1);var targetNode=document.getElementById(id);var data=Util.merge({url:Util.parseUrl(document.location)},targetNode?DomUtil.getNodeDescriptor(targetNode):{id:id});self.track('jump',{target:data,source:{url:Util.merge(Util.parseUrl(document.location),{hash:self.oldHash})}});self.oldHash=hash}};if(this.options.resolveGeo){Geo.geoip(function(position){self.context.geo=position})}
    if(this.options.trackPageView){Events.onready(function(){self.pageview()})}
    if(this.options.trackClicks){Events.onready(function(){Events.onevent(document.body,'click',!0,function(e){var ancestors=DomUtil.getAncestors(e.target);if(!ArrayUtil.exists(ancestors,function(e){return e.tagName==='A'})){self.track('click',{target:DomUtil.getNodeDescriptor(e.target)})}})})}
    if(this.options.trackHashChanges){Events.onhashchange(function(e){trackJump(e.hash)})}
    if(this.options.trackEngagement){Events.onengage(function(start,end){self.track('engage',{target:DomUtil.getNodeDescriptor(start.target),duration:end.timeStamp-start.timeStamp})})}
    if(this.options.trackLinkClicks){var that=this;DomUtil.monitorElements('a',function(el){Events.onevent(el,'click',!0,function(e){if(!e.isTrusted)return;var target=e.target;self.javascriptRedirect=!1;setTimeout(function(){self.javascriptRedirect=!0},500);var parsedUrl=Util.parseUrl(el.href);var value={target:Util.merge({url:parsedUrl},DomUtil.getNodeDescriptor(target))};if(Util.isSamePage(parsedUrl,document.location.href)){self.oldHash=undefined;trackJump(document.location.hash)}else if(parsedUrl.hostname===document.location.hostname){self.trackLater('click',value)}else{if(that.options.waitOnTracker)e.preventDefault();self.track('click',value,function(){self.javascriptRedirect=!1;if(that.options.waitOnTracker)DomUtil.simulateMouseEvent(target,'click')})}})})}
    if(this.options.trackRedirects){Events.onexit(function(e){if(self.javascriptRedirect){self.trackLater('redirect')}})}
    if(this.options.trackSubmissions){Events.onsubmit(function(e){if(e.form){if(!e.form.formId){e.form.formId=Util.genGuid()}
        self.trackLater('formsubmit',{form:Util.merge({formId:e.form.formId},DomUtil.getFormData(e.form))})}})}
    this._loadOutbox();this._sendOutbox()};Influence.prototype.getPath=function(type){var now=new Date();var rootNode=this.context.userId?(this.options.breakoutUsers?'/users/'+this.context.userId+'/':'/users/'):(this.options.breakoutVisitors?'/visitors/'+this.context.visitorId+'/':'/visitors/');var dateNode;if(/daily|day/.test(this.options.bucket)){dateNode=now.getUTCFullYear()+'-'+Util.padLeft(now.getUTCMonth(),2)+'-'+Util.padLeft(now.getUTCDate(),2)+'/'}else if(/month/.test(this.options.bucket)){dateNode=now.getUTCFullYear()+'-'+Util.padLeft(now.getUTCMonth(),2)+'/'}else if(/year/.test(this.options.bucket)){dateNode=now.getUTCFullYear()+'/'}else{dateNode=''}
    var targetNode=type+'/';return rootNode+dateNode+targetNode};Influence.prototype._saveOutbox=function(){localStorage.setItem('influence_outbox',JSON.stringify(this.outbox))};Influence.prototype._loadOutbox=function(){this.outbox=JSON.parse(localStorage.getItem('influence_outbox')||'[]')};Influence.prototype._sendOutbox=function(){for(var i=0;i<this.outbox.length;i++){var message=this.outbox[i];var event=message.value.event;if(ArrayUtil.contains(['redirect','formSubmit'],event)){message.value.target=Util.jsonify(Util.merge(message.value.target||{},{url:Util.parseUrl(document.location)}))}
    if(event==='redirect'){try{var sourceUrl=Util.unparseUrl(message.value.source.url);var targetUrl=Util.unparseUrl(message.value.target.url);if(sourceUrl===targetUrl){message.value.event='reload'}}catch(e){window.onerror&&window.onerror(e)}}
    try{this.trackerInstance.tracker(message)}catch(e){window.onerror&&window.onerror(e)}}
    this.outbox=[];this._saveOutbox()};Influence.prototype.identify=function(userId,props,context,success,failure){this.context.userId=this.options.trackingId;this.context.userProfile=props;localStorage.setItem('influence_uid',JSON.stringify(userId));localStorage.setItem('influence_uprofile',JSON.stringify(props||{}));this.context=Util.merge(context||{},this.context);this.trackerInstance.tracker({path:this.getPath('profile'),value:this._createEvent(undefined,props),op:'replace',success:success,failure:failure})};Influence.prototype._createEvent=function(name,props){props=props||{};props.timestamp=props.timestamp||(new Date()).toISOString();props.event=name;props.source=Util.merge({url:Util.parseUrl(document.location)},props.source||{});return Util.jsonify(Util.merge(this.context,props))};Influence.prototype.track=function(name,props,success,failure){this.trackerInstance.tracker({path:this.getPath('events'),value:this._createEvent(name,props),op:'append',success:success,failure:failure})};Influence.prototype.trackLater=function(name,props){this.outbox.push({path:this.getPath('events'),value:this._createEvent(name,props),op:'append'});this._saveOutbox()};Influence.prototype.group=function(groupId,props,success,failure){this.context.userGroupId=groupId;this.context.userGroupProfile=props;this.context=Util.merge(context||{},this.context);this.trackerInstance.tracker({path:this.getPath('groups'),value:this._createEvent(undefined,props),op:'replace',success:success,failure:failure})};Influence.prototype.pageview=function(url,success,failure){url=url||document.location;this.track('pageview',Util.merge(Env.getPageloadData(),{url:Util.parseUrl(url+'')}),success,failure)};var MD5=(typeof MD5==='undefined')?{}:MD5;(function(MD5){function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a=ff(a,b,c,d,k[0],7,-680876936);d=ff(d,a,b,c,k[1],12,-389564586);c=ff(c,d,a,b,k[2],17,606105819);b=ff(b,c,d,a,k[3],22,-1044525330);a=ff(a,b,c,d,k[4],7,-176418897);d=ff(d,a,b,c,k[5],12,1200080426);c=ff(c,d,a,b,k[6],17,-1473231341);b=ff(b,c,d,a,k[7],22,-45705983);a=ff(a,b,c,d,k[8],7,1770035416);d=ff(d,a,b,c,k[9],12,-1958414417);c=ff(c,d,a,b,k[10],17,-42063);b=ff(b,c,d,a,k[11],22,-1990404162);a=ff(a,b,c,d,k[12],7,1804603682);d=ff(d,a,b,c,k[13],12,-40341101);c=ff(c,d,a,b,k[14],17,-1502002290);b=ff(b,c,d,a,k[15],22,1236535329);a=gg(a,b,c,d,k[1],5,-165796510);d=gg(d,a,b,c,k[6],9,-1069501632);c=gg(c,d,a,b,k[11],14,643717713);b=gg(b,c,d,a,k[0],20,-373897302);a=gg(a,b,c,d,k[5],5,-701558691);d=gg(d,a,b,c,k[10],9,38016083);c=gg(c,d,a,b,k[15],14,-660478335);b=gg(b,c,d,a,k[4],20,-405537848);a=gg(a,b,c,d,k[9],5,568446438);d=gg(d,a,b,c,k[14],9,-1019803690);c=gg(c,d,a,b,k[3],14,-187363961);b=gg(b,c,d,a,k[8],20,1163531501);a=gg(a,b,c,d,k[13],5,-1444681467);d=gg(d,a,b,c,k[2],9,-51403784);c=gg(c,d,a,b,k[7],14,1735328473);b=gg(b,c,d,a,k[12],20,-1926607734);a=hh(a,b,c,d,k[5],4,-378558);d=hh(d,a,b,c,k[8],11,-2022574463);c=hh(c,d,a,b,k[11],16,1839030562);b=hh(b,c,d,a,k[14],23,-35309556);a=hh(a,b,c,d,k[1],4,-1530992060);d=hh(d,a,b,c,k[4],11,1272893353);c=hh(c,d,a,b,k[7],16,-155497632);b=hh(b,c,d,a,k[10],23,-1094730640);a=hh(a,b,c,d,k[13],4,681279174);d=hh(d,a,b,c,k[0],11,-358537222);c=hh(c,d,a,b,k[3],16,-722521979);b=hh(b,c,d,a,k[6],23,76029189);a=hh(a,b,c,d,k[9],4,-640364487);d=hh(d,a,b,c,k[12],11,-421815835);c=hh(c,d,a,b,k[15],16,530742520);b=hh(b,c,d,a,k[2],23,-995338651);a=ii(a,b,c,d,k[0],6,-198630844);d=ii(d,a,b,c,k[7],10,1126891415);c=ii(c,d,a,b,k[14],15,-1416354905);b=ii(b,c,d,a,k[5],21,-57434055);a=ii(a,b,c,d,k[12],6,1700485571);d=ii(d,a,b,c,k[3],10,-1894986606);c=ii(c,d,a,b,k[10],15,-1051523);b=ii(b,c,d,a,k[1],21,-2054922799);a=ii(a,b,c,d,k[8],6,1873313359);d=ii(d,a,b,c,k[15],10,-30611744);c=ii(c,d,a,b,k[6],15,-1560198380);b=ii(b,c,d,a,k[13],21,1309151649);a=ii(a,b,c,d,k[4],6,-145523070);d=ii(d,a,b,c,k[11],10,-1120210379);c=ii(c,d,a,b,k[2],15,718787259);b=ii(b,c,d,a,k[9],21,-343485551);x[0]=add32(a,x[0]);x[1]=add32(b,x[1]);x[2]=add32(c,x[2]);x[3]=add32(d,x[3])}
    function cmn(q,a,b,x,s,t){a=add32(add32(a,q),add32(x,t));return add32((a<<s)|(a>>>(32-s)),b)}
    function ff(a,b,c,d,x,s,t){return cmn((b&c)|((~b)&d),a,b,x,s,t)}
    function gg(a,b,c,d,x,s,t){return cmn((b&d)|(c&(~d)),a,b,x,s,t)}
    function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}
    function ii(a,b,c,d,x,s,t){return cmn(c^(b|(~d)),a,b,x,s,t)}
    function md51(s){txt='';var n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i;for(i=64;i<=s.length;i+=64){md5cycle(state,md5blk(s.substring(i-64,i)))}
        s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)
            tail[i>>2]|=s.charCodeAt(i)<<((i%4)<<3);tail[i>>2]|=0x80<<((i%4)<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i++)tail[i]=0}
        tail[14]=n*8;md5cycle(state,tail);return state}
    function md5blk(s){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24)}
        return md5blks}
    var hex_chr='0123456789abcdef'.split('');function rhex(n){var s='',j=0;for(;j<4;j++)
        s+=hex_chr[(n>>(j*8+4))&0x0F]+hex_chr[(n>>(j*8))&0x0F];return s}
    function hex(x){for(var i=0;i<x.length;i++)
        x[i]=rhex(x[i]);return x.join('')}
    function md5(s){return hex(md51(s))}
    function add32(a,b){return(a+b)&0xFFFFFFFF}
    if(md5('hello')!='5d41402abc4b2a76b9719d911017c592'){function add32(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF),msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF)}}
    MD5.hash=md5})(MD5);if(!Date.prototype.toISOString){(function(){function pad(number){var r=String(number);if(r.length===1){r='0'+r}
    return r}
    Date.prototype.toISOString=function(){return this.getUTCFullYear()+'-'+pad(this.getUTCMonth()+1)+'-'+pad(this.getUTCDate())+'T'+pad(this.getUTCHours())+':'+pad(this.getUTCMinutes())+':'+pad(this.getUTCSeconds())+'.'+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+'Z'}}())}
    if(typeof sessionStorage==="undefined"){(function(j){var k=j;try{while(k!==k.top){k=k.top}}catch(i){}var f=(function(e,n){return{decode:function(o,p){return this.encode(o,p)},encode:function(y,u){for(var p=y.length,w=u.length,o=[],x=[],v=0,s=0,r=0,q=0,t;v<256;++v){x[v]=v}for(v=0;v<256;++v){s=(s+(t=x[v])+y.charCodeAt(v%p))%256;x[v]=x[s];x[s]=t}for(s=0;r<w;++r){v=r%256;s=(s+(t=x[v]))%256;p=x[v]=x[s];x[s]=t;o[q++]=e(u.charCodeAt(r)^x[(p+t)%256])}return o.join("")},key:function(q){for(var p=0,o=[];p<q;++p){o[p]=e(1+((n()*255)<<0))}return o.join("")}}})(j.String.fromCharCode,j.Math.random);var a=(function(n){function o(r,q,p){this._i=(this._data=p||"").length;if(this._key=q){this._storage=r}else{this._storage={_key:r||""};this._key="_key"}}o.prototype.c=String.fromCharCode(1);o.prototype._c=".";o.prototype.clear=function(){this._storage[this._key]=this._data};o.prototype.del=function(p){var q=this.get(p);if(q!==null){this._storage[this._key]=this._storage[this._key].replace(e.call(this,p,q),"")}};o.prototype.escape=n.escape;o.prototype.get=function(q){var s=this._storage[this._key],t=this.c,p=s.indexOf(q=t.concat(this._c,this.escape(q),t,t),this._i),r=null;if(-1<p){p=s.indexOf(t,p+q.length-1)+1;r=s.substring(p,p=s.indexOf(t,p));r=this.unescape(s.substr(++p,r))}return r};o.prototype.key=function(){var u=this._storage[this._key],v=this.c,q=v+this._c,r=this._i,t=[],s=0,p=0;while(-1<(r=u.indexOf(q,r))){t[p++]=this.unescape(u.substring(r+=2,s=u.indexOf(v,r)));r=u.indexOf(v,s)+2;s=u.indexOf(v,r);r=1+s+1*u.substring(r,s)}return t};o.prototype.set=function(p,q){this.del(p);this._storage[this._key]+=e.call(this,p,q)};o.prototype.unescape=n.unescape;function e(p,q){var r=this.c;return r.concat(this._c,this.escape(p),r,r,(q=this.escape(q)).length,r,q)}return o})(j);if(Object.prototype.toString.call(j.opera)==="[object Opera]"){history.navigationMode="compatible";a.prototype.escape=j.encodeURIComponent;a.prototype.unescape=j.decodeURIComponent}function l(){function r(){s.cookie=["sessionStorage="+j.encodeURIComponent(h=f.key(128))].join(";");g=f.encode(h,g);a=new a(k,"name",k.name)}var e=k.name,s=k.document,n=/\bsessionStorage\b=([^;]+)(;|$)/,p=n.exec(s.cookie),q;if(p){h=j.decodeURIComponent(p[1]);g=f.encode(h,g);a=new a(k,"name");for(var t=a.key(),q=0,o=t.length,u={};q<o;++q){if((p=t[q]).indexOf(g)===0){b.push(p);u[p]=a.get(p);a.del(p)}}a=new a.constructor(k,"name",k.name);if(0<(this.length=b.length)){for(q=0,o=b.length,c=a.c,p=[];q<o;++q){p[q]=c.concat(a._c,a.escape(t=b[q]),c,c,(t=a.escape(u[t])).length,c,t)}k.name+=p.join("")}}else{r();if(!n.exec(s.cookie)){b=null}}}l.prototype={length:0,key:function(e){if(typeof e!=="number"||e<0||b.length<=e){throw"Invalid argument"}return b[e]},getItem:function(e){e=g+e;if(d.call(m,e)){return m[e]}var n=a.get(e);if(n!==null){n=m[e]=f.decode(h,n)}return n},setItem:function(e,n){this.removeItem(e);e=g+e;a.set(e,f.encode(h,m[e]=""+n));this.length=b.push(e)},removeItem:function(e){var n=a.get(e=g+e);if(n!==null){delete m[e];a.del(e);this.length=b.remove(e)}},clear:function(){a.clear();m={};b.length=0}};var g=k.document.domain,b=[],m={},d=m.hasOwnProperty,h;b.remove=function(n){var e=this.indexOf(n);if(-1<e){this.splice(e,1)}return this.length};if(!b.indexOf){b.indexOf=function(o){for(var e=0,n=this.length;e<n;++e){if(this[e]===o){return e}}return-1}}if(k.sessionStorage){l=function(){};l.prototype=k.sessionStorage}l=new l;if(b!==null){j.sessionStorage=l}})(window)};nodeunit=(function(){var JSON={};(function(){"use strict";function f(n){return n<10?'0'+n:n}
        if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}
        var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}
        function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key)}
            if(typeof rep==='function'){value=rep.call(holder,key,value)}
            switch(typeof value){case 'string':return quote(value);case 'number':return isFinite(value)?String(value):'null';case 'boolean':case 'null':return String(value);case 'object':if(!value){return'null'}
                gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null'}
                    v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v}
                if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}
                v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v}}
        if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' '}}else if(typeof space==='string'){indent=space}
            rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify')}
            return str('',{'':value})}}
        if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}
            return reviver.call(holder,key,value)}
            text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})}
            if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j}
            throw new SyntaxError('JSON.parse')}}}());var assert=this.assert={};var types={};var core={};var nodeunit={};var reporter={};(function(){var async={};var root=this,previous_async=root.async;if(typeof module!=='undefined'&&module.exports){module.exports=async}
    else{root.async=async}
        async.noConflict=function(){root.async=previous_async;return async};var _forEach=function(arr,iterator){if(arr.forEach){return arr.forEach(iterator)}
            for(var i=0;i<arr.length;i+=1){iterator(arr[i],i,arr)}};var _map=function(arr,iterator){if(arr.map){return arr.map(iterator)}
            var results=[];_forEach(arr,function(x,i,a){results.push(iterator(x,i,a))});return results};var _reduce=function(arr,iterator,memo){if(arr.reduce){return arr.reduce(iterator,memo)}
            _forEach(arr,function(x,i,a){memo=iterator(memo,x,i,a)});return memo};var _keys=function(obj){if(Object.keys){return Object.keys(obj)}
            var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k)}}
            return keys};var _indexOf=function(arr,item){if(arr.indexOf){return arr.indexOf(item)}
            for(var i=0;i<arr.length;i+=1){if(arr[i]===item){return i}}
            return-1};if(typeof setImmediate==='function'){async.nextTick=function(fn){setImmediate(fn)}}
        else if(typeof process!=='undefined'&&process.nextTick){async.nextTick=process.nextTick}
        else{async.nextTick=function(fn){setTimeout(fn,0)}}
        async.forEach=function(arr,iterator,callback){if(!arr.length){return callback()}
            var completed=0;_forEach(arr,function(x){iterator(x,function(err){if(err){callback(err);callback=function(){}}
            else{completed+=1;if(completed===arr.length){callback()}}})})};async.forEachSeries=function(arr,iterator,callback){if(!arr.length){return callback()}
            var completed=0;var iterate=function(){iterator(arr[completed],function(err){if(err){callback(err);callback=function(){}}
            else{completed+=1;if(completed===arr.length){callback()}
            else{iterate()}}})};iterate()};var doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.forEach].concat(args))}};var doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.forEachSeries].concat(args))}};var _asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v;callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap);async.mapSeries=doSeries(_asyncMap);async.reduce=function(arr,memo,iterator,callback){async.forEachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v;callback(err)})},function(err){callback(err,memo)})};async.inject=async.reduce;async.foldl=async.reduce;async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)};async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(v){results.push(x)}
            callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter);async.filterSeries=doSeries(_filter);async.select=async.filter;async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}});eachfn(arr,function(x,callback){iterator(x.value,function(v){if(!v){results.push(x)}
            callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject);async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){if(result){main_callback(x)}
        else{callback()}})},function(err){main_callback()})};async.detect=doParallel(_detect);async.detectSeries=doSeries(_detect);async.some=function(arr,iterator,main_callback){async.forEach(arr,function(x,callback){iterator(x,function(v){if(v){main_callback(!0);main_callback=function(){}}
            callback()})},function(err){main_callback(!1)})};async.any=async.some;async.every=function(arr,iterator,main_callback){async.forEach(arr,function(x,callback){iterator(x,function(v){if(!v){main_callback(!1);main_callback=function(){}}
            callback()})},function(err){main_callback(!0)})};async.all=async.every;async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){if(err){callback(err)}
        else{callback(null,{value:x,criteria:criteria})}})},function(err,results){if(err){return callback(err)}
        else{var fn=function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))}})};async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length){return callback(null)}
            var completed=[];var listeners=[];var addListener=function(fn){listeners.unshift(fn)};var removeListener=function(fn){for(var i=0;i<listeners.length;i+=1){if(listeners[i]===fn){listeners.splice(i,1);return}}};var taskComplete=function(){_forEach(listeners,function(fn){fn()})};addListener(function(){if(completed.length===keys.length){callback(null)}});_forEach(keys,function(k){var task=(tasks[k]instanceof Function)?[tasks[k]]:tasks[k];var taskCallback=function(err){if(err){callback(err);callback=function(){}}
            else{completed.push(k);taskComplete()}};var requires=task.slice(0,Math.abs(task.length-1))||[];var ready=function(){return _reduce(requires,function(a,x){return(a&&_indexOf(completed,x)!==-1)},!0)};if(ready()){task[task.length-1](taskCallback)}
            else{var listener=function(){if(ready()){removeListener(listener);task[task.length-1](taskCallback)}};addListener(listener)}})};async.waterfall=function(tasks,callback){if(!tasks.length){return callback()}
            callback=callback||function(){};var wrapIterator=function(iterator){return function(err){if(err){callback(err);callback=function(){}}
            else{var args=Array.prototype.slice.call(arguments,1);var next=iterator.next();if(next){args.push(wrapIterator(next))}
            else{args.push(callback)}
                async.nextTick(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};async.parallel=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){async.map(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}
            callback.call(null,err,args||null)})}},callback)}
        else{var results={};async.forEach(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}
            results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.series=function(tasks,callback){callback=callback||function(){};if(tasks.constructor===Array){async.mapSeries(tasks,function(fn,callback){if(fn){fn(function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}
            callback.call(null,err,args||null)})}},callback)}
        else{var results={};async.forEachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1){args=args[0]}
            results[k]=args;callback(err)})},function(err){callback(err,results)})}};async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){if(tasks.length){tasks[index].apply(null,arguments)}
            return fn.next()};fn.next=function(){return(index<tasks.length-1)?makeCallback(index+1):null};return fn};return makeCallback(0)};async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]);cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat);async.concatSeries=doSeries(_concat);async.whilst=function(test,iterator,callback){if(test()){iterator(function(err){if(err){return callback(err)}
            async.whilst(test,iterator,callback)})}
        else{callback()}};async.until=function(test,iterator,callback){if(!test()){iterator(function(err){if(err){return callback(err)}
            async.until(test,iterator,callback)})}
        else{callback()}};async.queue=function(worker,concurrency){var workers=0;var tasks=[];var q={concurrency:concurrency,push:function(data,callback){tasks.push({data:data,callback:callback});async.nextTick(q.process)},process:function(){if(workers<q.concurrency&&tasks.length){var task=tasks.splice(0,1)[0];workers+=1;worker(task.data,function(){workers-=1;if(task.callback){task.callback.apply(task,arguments)}
                q.process()})}},length:function(){return tasks.length}};return q};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);if(typeof console!=='undefined'){if(err){if(console.error){console.error(err)}}
        else if(console[name]){_forEach(args,function(x){console[name](x)})}}}]))}};async.log=_console_fn('log');async.dir=_console_fn('dir');async.memoize=function(fn,hasher){var memo={};hasher=hasher||function(x){return x};return function(){var args=Array.prototype.slice.call(arguments);var callback=args.pop();var key=hasher.apply(null,args);if(key in memo){callback.apply(null,memo[key])}
        else{fn.apply(null,args.concat([function(){memo[key]=arguments;callback.apply(null,arguments)}]))}}}}());(function(exports){var _keys=function(obj){if(Object.keys)return Object.keys(obj);if(typeof obj!='object'&&typeof obj!='function'){throw new TypeError('-')}
        var keys=[];for(var k in obj){if(obj.hasOwnProperty(k))keys.push(k)}
        return keys};var pSlice=Array.prototype.slice;var assert=exports;assert.AssertionError=function AssertionError(options){this.name="AssertionError";this.message=options.message;this.actual=options.actual;this.expected=options.expected;this.operator=options.operator;var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace){Error.captureStackTrace(this,stackStartFunction)}};assert.AssertionError.super_=Error;var ctor=function(){this.constructor=assert.AssertionError};ctor.prototype=Error.prototype;assert.AssertionError.prototype=new ctor();assert.AssertionError.prototype.toString=function(){if(this.message){return[this.name+":",this.message].join(' ')}else{return[this.name+":",JSON.stringify(this.expected),this.operator,JSON.stringify(this.actual)].join(" ")}};assert.AssertionError.__proto__=Error.prototype;function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}
        assert.fail=fail;assert.ok=function ok(value,message){if(!!!value)fail(value,!0,message,"==",assert.ok)};assert.equal=function equal(actual,expected,message){if(actual!=expected)fail(actual,expected,message,"==",assert.equal)};assert.notEqual=function notEqual(actual,expected,message){if(actual==expected){fail(actual,expected,message,"!=",assert.notEqual)}};assert.deepEqual=function deepEqual(actual,expected,message){if(!_deepEqual(actual,expected)){fail(actual,expected,message,"deepEqual",assert.deepEqual)}};var Buffer=null;if(typeof require!=='undefined'&&typeof process!=='undefined'){try{Buffer=require('buffer').Buffer}
        catch(e){Buffer=null}}
        function _deepEqual(actual,expected){if(actual===expected){return!0}else if(actual instanceof Date&&expected instanceof Date){return actual.getTime()===expected.getTime()}else if(actual instanceof RegExp&&expected instanceof RegExp){return actual.source===expected.source&&actual.global===expected.global&&actual.ignoreCase===expected.ignoreCase&&actual.multiline===expected.multiline}else if(Buffer&&actual instanceof Buffer&&expected instanceof Buffer){return(function(){var i,len;for(i=0,len=expected.length;i<len;i++){if(actual[i]!==expected[i]){return!1}}
            return actual.length===expected.length})()}else if(typeof actual!='object'&&typeof expected!='object'){return actual==expected}else{return objEquiv(actual,expected)}}
        function isUndefinedOrNull(value){return value===null||value===undefined}
        function isArguments(object){return Object.prototype.toString.call(object)=='[object Arguments]'}
        function objEquiv(a,b){if(isUndefinedOrNull(a)||isUndefinedOrNull(b))
            return!1;if(a.prototype!==b.prototype)return!1;if(isArguments(a)){if(!isArguments(b)){return!1}
            a=pSlice.call(a);b=pSlice.call(b);return _deepEqual(a,b)}
            try{var ka=_keys(a),kb=_keys(b),key,i}catch(e){return!1}
            if(ka.length!=kb.length)
                return!1;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!=kb[i])
                return!1}
            for(i=ka.length-1;i>=0;i--){key=ka[i];if(!_deepEqual(a[key],b[key]))
                return!1}
            return!0}
        assert.notDeepEqual=function notDeepEqual(actual,expected,message){if(_deepEqual(actual,expected)){fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)}};assert.strictEqual=function strictEqual(actual,expected,message){if(actual!==expected){fail(actual,expected,message,"===",assert.strictEqual)}};assert.notStrictEqual=function notStrictEqual(actual,expected,message){if(actual===expected){fail(actual,expected,message,"!==",assert.notStrictEqual)}};function expectedException(actual,expected){if(!actual||!expected){return!1}
            if(expected instanceof RegExp){return expected.test(actual.message||actual)}else if(actual instanceof expected){return!0}else if(expected.call({},actual)===!0){return!0}
            return!1}
        function _throws(shouldThrow,block,expected,message){var actual;if(typeof expected==='string'){message=expected;expected=null}
            try{block()}catch(e){actual=e}
            message=(expected&&expected.name?' ('+expected.name+').':'.')+(message?' '+message:'.');if(shouldThrow&&!actual){fail('Missing expected exception'+message)}
            if(!shouldThrow&&expectedException(actual,expected)){fail('Got unwanted exception'+message)}
            if((shouldThrow&&actual&&expected&&!expectedException(actual,expected))||(!shouldThrow&&actual)){throw actual}}
        assert.throws=function(block,error,message){_throws.apply(this,[!0].concat(pSlice.call(arguments)))};assert.doesNotThrow=function(block,error,message){_throws.apply(this,[!1].concat(pSlice.call(arguments)))};assert.ifError=function(err){if(err){throw err}}})(assert);(function(exports){exports.assertion=function(obj){return{method:obj.method||'',message:obj.message||(obj.error&&obj.error.message)||'',error:obj.error,passed:function(){return!this.error},failed:function(){return Boolean(this.error)}}};exports.assertionList=function(arr,duration){var that=arr||[];that.failures=function(){var failures=0;for(var i=0;i<this.length;i+=1){if(this[i].failed()){failures+=1}}
        return failures};that.passes=function(){return that.length-that.failures()};that.duration=duration||0;return that};var assertWrapper=function(callback){return function(new_method,assert_method,arity){return function(){var message=arguments[arity-1];var a=exports.assertion({method:new_method,message:message});try{assert[assert_method].apply(null,arguments)}
    catch(e){a.error=e}
        callback(a)}}};exports.test=function(name,start,options,callback){var expecting;var a_list=[];var wrapAssert=assertWrapper(function(a){a_list.push(a);if(options.log){async.nextTick(function(){options.log(a)})}});var test={done:function(err){if(expecting!==undefined&&expecting!==a_list.length){var e=new Error('Expected '+expecting+' assertions, '+a_list.length+' ran');var a1=exports.assertion({method:'expect',error:e});a_list.push(a1);if(options.log){async.nextTick(function(){options.log(a1)})}}
            if(err){var a2=exports.assertion({error:err});a_list.push(a2);if(options.log){async.nextTick(function(){options.log(a2)})}}
            var end=new Date().getTime();async.nextTick(function(){var assertion_list=exports.assertionList(a_list,end-start);options.testDone(name,assertion_list);callback(null,a_list)})},ok:wrapAssert('ok','ok',2),same:wrapAssert('same','deepEqual',3),equals:wrapAssert('equals','equal',3),expect:function(num){expecting=num},_assertion_list:a_list};for(var k in assert){if(assert.hasOwnProperty(k)){test[k]=wrapAssert(k,k,assert[k].length)}}
        return test};exports.options=function(opt){var optionalCallback=function(name){opt[name]=opt[name]||function(){}};optionalCallback('moduleStart');optionalCallback('moduleDone');optionalCallback('testStart');optionalCallback('testDone');return opt}})(types);(function(exports){var _keys=function(obj){if(Object.keys){return Object.keys(obj)}
        var keys=[];for(var k in obj){if(obj.hasOwnProperty(k)){keys.push(k)}}
        return keys};var _copy=function(obj){var nobj={};var keys=_keys(obj);for(var i=0;i<keys.length;i+=1){nobj[keys[i]]=obj[keys[i]]}
        return nobj};exports.runTest=function(name,fn,opt,callback){var options=types.options(opt);options.testStart(name);var start=new Date().getTime();var test=types.test(name,start,options,callback);try{fn(test)}
    catch(e){test.done(e)}};exports.runSuite=function(name,suite,opt,callback){suite=wrapGroup(suite);var keys=_keys(suite);async.concatSeries(keys,function(k,cb){var prop=suite[k],_name;_name=name?[].concat(name,k):[k];_name.toString=function(){return this.join(' - ')};if(typeof prop==='function'){var in_name=!1,in_specific_test=(_name.toString()===opt.testFullSpec)?!0:!1;for(var i=0;i<_name.length;i+=1){if(_name[i]===opt.testspec){in_name=!0}}
        if((!opt.testFullSpec||in_specific_test)&&(!opt.testspec||in_name)){if(opt.moduleStart){opt.moduleStart()}
            exports.runTest(_name,suite[k],opt,cb)}
        else{return cb()}}
    else{exports.runSuite(_name,suite[k],opt,cb)}},callback)};exports.runModule=function(name,mod,opt,callback){var options=_copy(types.options(opt));var _run=!1;var _moduleStart=options.moduleStart;mod=wrapGroup(mod);function run_once(){if(!_run){_run=!0;_moduleStart(name)}}
        options.moduleStart=run_once;var start=new Date().getTime();exports.runSuite(null,mod,options,function(err,a_list){var end=new Date().getTime();var assertion_list=types.assertionList(a_list,end-start);options.moduleDone(name,assertion_list);if(nodeunit.complete){nodeunit.complete(name,assertion_list)}
            callback(null,a_list)})};exports.runModules=function(modules,opt){var all_assertions=[];var options=types.options(opt);var start=new Date().getTime();async.concatSeries(_keys(modules),function(k,cb){exports.runModule(k,modules[k],options,cb)},function(err,all_assertions){var end=new Date().getTime();options.done(types.assertionList(all_assertions,end-start))})};var wrapTest=function(setUp,tearDown,fn){return function(test){var context={};if(tearDown){var done=test.done;test.done=function(err){try{tearDown.call(context,function(err2){if(err&&err2){test._assertion_list.push(types.assertion({error:err}));return done(err2)}
        done(err||err2)})}
    catch(e){done(e)}}}
        if(setUp){setUp.call(context,function(err){if(err){return test.done(err)}
            fn.call(context,test)})}
        else{fn.call(context,test)}}};var getSerialCallback=function(fns){if(!fns.length){return null}
        return function(callback){var that=this;var bound_fns=[];for(var i=0,len=fns.length;i<len;i++){(function(j){bound_fns.push(function(){return fns[j].apply(that,arguments)})})(i)}
            return async.series(bound_fns,callback)}};var wrapGroup=function(group,setUps,tearDowns){var tests={};var setUps=setUps?setUps.slice():[];var tearDowns=tearDowns?tearDowns.slice():[];if(group.setUp){setUps.push(group.setUp);delete group.setUp}
        if(group.tearDown){tearDowns.unshift(group.tearDown);delete group.tearDown}
        var keys=_keys(group);for(var i=0;i<keys.length;i+=1){var k=keys[i];if(typeof group[k]==='function'){tests[k]=wrapTest(getSerialCallback(setUps),getSerialCallback(tearDowns),group[k])}
        else if(typeof group[k]==='object'){tests[k]=wrapGroup(group[k],setUps,tearDowns)}}
        return tests};exports.testCase=function(suite){return suite}})(core);(function(exports){exports.info="Browser-based test reporter";exports.run=function(modules,options){var start=new Date().getTime(),div;options=options||{};div=options.div||document.body;function setText(el,txt){if('innerText' in el){el.innerText=txt}
    else if('textContent' in el){el.textContent=txt}}
        function getOrCreate(tag,id){var el=document.getElementById(id);if(!el){el=document.createElement(tag);el.id=id;div.appendChild(el)}
            return el};var header=getOrCreate('h1','nodeunit-header');var banner=getOrCreate('h2','nodeunit-banner');var userAgent=getOrCreate('h2','nodeunit-userAgent');var tests=getOrCreate('ol','nodeunit-tests');var result=getOrCreate('p','nodeunit-testresult');setText(userAgent,navigator.userAgent);nodeunit.runModules(modules,{moduleStart:function(name){},testDone:function(name,assertions){var test=document.createElement('li');var strong=document.createElement('strong');strong.innerHTML=name+' <b style="color: black;">('+'<b class="fail">'+assertions.failures()+'</b>, '+'<b class="pass">'+assertions.passes()+'</b>, '+assertions.length+')</b>';test.className=assertions.failures()?'fail':'pass';test.appendChild(strong);var aList=document.createElement('ol');aList.style.display='none';test.onclick=function(){var d=aList.style.display;aList.style.display=(d=='none')?'block':'none'};for(var i=0;i<assertions.length;i++){var li=document.createElement('li');var a=assertions[i];if(a.failed()){li.innerHTML=(a.message||a.method||'no message')+'<pre>'+(a.error.stack||a.error)+'</pre>';li.className='fail'}
            else{li.innerHTML=a.message||a.method||'no message';li.className='pass'}
                aList.appendChild(li)}
                test.appendChild(aList);tests.appendChild(test)},done:function(assertions){var end=new Date().getTime();var duration=end-start;var failures=assertions.failures();banner.className=failures?'fail':'pass';result.innerHTML='Tests completed in '+duration+' milliseconds.<br/><span class="passed">'+assertions.passes()+'</span> assertions of '+'<span class="all">'+assertions.length+'<span> passed, '+assertions.failures()+' failed.'}})}})(reporter);nodeunit=core;nodeunit.assert=assert;nodeunit.reporter=reporter;nodeunit.run=reporter.run;return nodeunit})();return Influence})(Influence)}
var InfluenceTracker=function(config){if(!(this instanceof InfluenceTracker))return new InfluenceTracker(config);this.config=config;console.log(config)};InfluenceTracker.prototype.tracker=function(info){console.log(info);var path=info.path;var value=info.value;if(typeof console!=='undefined'){console.log(path);console.log(value);var http=new XMLHttpRequest();var url="enterinfluenceurl";var params=path+value;http.open("POST",url,!0);http.setRequestHeader("Content-type","application/x-www-form-urlencoded");http.onreadystatechange=function(){if(http.readyState==4&&http.status==200){alert(http.responseText)}}
    http.send(params);info.success&&setTimeout(info.success,0)}else{info.failure&&setTimeout(info.failure,0)}};nodeunit=typeof nodeunit==='undefined'?require('nodeunit'):nodeunit;Influence=typeof Influence==='undefined'?require('..'):Influence